# vulnerability_test
Pulls pip information and OS installed packages and check if the installed version has a registered CVE. The tool knows to find relevant CVE for a program and remove rejected CVEs.

# motivation
NPM has integrated the [audit tool](https://docs.npmjs.com/cli/audit) into the program.
This tool can show the number of vulnerable packages you are using in your project and help you to update the packages to a newer-secured version. (without breaking the dependencies) I thought it will be interesting to know how vulnerable my current python-pip packages. In contrast to npm, the packages are installed globally and therefore more vulnerable from a couple of projects (unless you use conda environments)

Later I extend the tool to support searching CVEs for windows programs and ubuntu programs.

# How to run
full inspect os + pip - python3 app.py
just pip inspection - Jupyter notebook (in the attached output, you can see it caught 3 CVEs for my pip in windows 10 PC)

I ran the script on ubuntu - output on ubuntu.txt, overall it perform better on ubuntu than windows because of the apt-get package manager which order all my installs.

# Implementation
The implementation is based on getting a program version through existed CLI.
To get python-pip packages' versions I used `pip freeze`.
The naming and the format are clean and good to use.
After parsing the output, the program search for each pip package in his CVES.
I used https://cve.mitre.org for listing the CVE and https://cve.circl.lu/api/ for detailed JSON on each CVE.
The JSON contained a field that can help to determine if the CVE is related.
I based on it to filter the relevant CVES.

`"vulnerable_product": ["cpe:2.3:a:microsoft:skype:8.35:*:*:*:*:android:*:*"]`

Overral it was fun project and it did found 3 CVEs on my pip of windows 10 PC (view notebook `safe_versions.ipynb`).
On my ubuntu WSL it found 6 apt-packages CVEs and 8 pip packages CVEs (view file `ubuntu.txt`).

# Extensions
I thought to add a support to get the OS installed programs' name and version.
I added support to get Linux (tested on UBUNTU18) installed packages 

`~$ dpkg -l`

And I added support to get windows (tested on windows10) installed programs
To get installed programs 

`PS ~ Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*`

To get more installed programs 

`PS ~ Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*`

To get Nicrosoft Store programs

`PS ~ Get-AppxPackage`

!!!Yet this is not full installed program!!! for example I did not find [Zoom](zoom.us) installation with this API

For each one, I piped the input through fields filter and table format preinstalled programs of PowerShell.
for example :
`PS ~ Get-AppxPackage | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize`

# Challenges
I had problems to fully use the API https://cve.circl.lu/api/.
Although they documented support of searching by name it did not work for me.
So I search for each program the CVES on https://cve.mitre.org and scrap the data.
Then I got detailed information about the CVE from the Circl API.

Even when I got the information from the Circl API, I had to validate the full name and the full version of the Installed program appear in the current CVE. Which is sometimes a problem because some program writes their name with 'version' of 'x64' which added unwanted results in mitre API.

Moreover, windows installation is not installed nicely with a package manager.
Each installation has a different naming scheme and some have missing versions.
Some naming schemas include architecture and name in the name of the program.
I had to use multiple API to get a partial list of windows installed program. (WMIC never finished running and seems as a bottle-neck to this project)